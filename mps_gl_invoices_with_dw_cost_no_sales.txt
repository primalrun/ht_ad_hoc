declare @datestart date = '2017-01-01'
declare @dateend date = '2017-05-31'


select
	q1.*
from (
select				
	gl.[Document No_],
	gl.[Posting Date],
	gl.[Document Date],
	gl.[Global Dimension 2 Code] as BU,
	-sum(case when glr.level_1 = 'Sales' then gl.Amount else 0 end) as Sales,
	sum(case when glr.level_1 = 'Cost' then gl.Amount else 0 end) as Cost
from NAVRep.dbo.[Hi Touch$G_L Entry] gl with(nolock)
	inner join NAVRep.dbo.[Hi Touch$G_L Account] gla
		on gl.[G_L Account No_] = gla.No_
	left outer join htdw.playground.[myop\jason.walker].gl_account_reporting glr
		on gl.[G_L Account No_] = glr.gl_account
		and glr.company = 'HT'
where	
	glr.level_1 in ('Sales', 'Cost')
	and gl.[Global Dimension 2 Code] = 'MPS'
	and gl.[Posting Date] between @datestart and @dateend
	and gl.[Document No_] in (
	'IN4042563',
'IN4055364',
'IN4055916',
'IN4067196',
'IN4067200',
'IN4068090',
'IN4068098',
'IN4068105',
'IN4068107',
'IN4068127',
'IN4068136',
'IN4068141',
'IN4068144',
'IN4068152',
'IN4068169',
'IN4072482',
'IN4081719',
'IN4081751',
'IN4081764',
'IN4083433',
'IN4083439',
'IN4083443',
'IN4083457',
'IN4083462',
'IN4083463',
'IN4083464',
'IN4083503',
'IN4083519',
'IN4083546',
'IN4083548',
'IN4083562',
'IN4083570',
'IN4135127',
'IN4142494',
'IN4142496',
'IN4142503',
'IN4148759',
'IN4148767',
'IN4148781',
'IN4148782',
'IN4148784',
'IN4148789',
'IN4148816',
'IN4148821',
'IN3997134',
'IN4042559',
'IN4055921',
'IN4062773',
'IN4067193',
'IN4068043',
'IN4068051',
'IN4068059',
'IN4068064',
'IN4068078',
'IN4068079',
'IN4068092',
'IN4068104',
'IN4068135',
'IN4068147',
'IN4068185',
'IN4068199',
'IN4083429',
'IN4083461',
'IN4083481',
'IN4083482',
'IN4083499',
'IN4083538',
'IN4083541',
'IN4083545',
'IN4083557',
'IN4083580',
'IN4084273',
'IN4135138',
'IN4148755',
'IN4148762',
'IN4148837',
'IN4148853',
'IN4149097',
'IN4149108',
'IN4149111',
'IN4149113',
'IN4149116',
'IN4149121',
'IN4149138',
'IN4149142',
'IN4055918',
'IN4067190',
'IN4068038',
'IN4068040',
'IN4068056',
'IN4068062',
'IN4068086',
'IN4068097',
'IN4068108',
'IN4068113',
'IN4068114',
'IN4068125',
'IN4068187',
'IN4075787',
'IN4081749',
'IN4081768',
'IN4082767',
'IN4083468',
'IN4083506',
'IN4083507',
'IN4083536',
'IN4083540',
'IN4083547',
'IN4083572',
'IN4083578',
'IN4083703',
'IN4125480',
'IN4135120',
'IN4142481',
'IN4148761',
'IN4148783',
'IN4148790',
'IN4148798',
'IN4148800',
'IN4148822',
'IN4148823',
'IN4148826',
'IN4148829',
'IN4148831',
'IN4148832',
'IN4148836',
'IN4067186',
'IN4067189',
'IN4068042',
'IN4068044',
'IN4068053',
'IN4068063',
'IN4068077',
'IN4068093',
'IN4068101',
'IN4068122',
'IN4068130',
'IN4068133',
'IN4068190',
'IN4072388',
'IN4081767',
'IN4081780',
'IN4083430',
'IN4083448',
'IN4083458',
'IN4083488',
'IN4083554',
'IN4116610',
'IN4150325',
'IN4148773',
'IN4148774',
'IN4148785',
'IN4148813',
'IN4148819',
'IN4148828',
'IN4148839',
'IN4148840',
'IN4148845',
'IN4148847',
'IN4148848',
'IN4148852',
'CM208876',
'IN4067185',
'IN4067187',
'IN4067192',
'IN4068112',
'IN4068126',
'IN4068129',
'IN4068142',
'IN4068154',
'IN4068160',
'IN4075794',
'IN4082772',
'IN4082784',
'IN4083426',
'IN4083435',
'IN4083440',
'IN4083445',
'IN4083465',
'IN4083518',
'IN4083522',
'IN4083544',
'IN4083564',
'IN4092690',
'CM212323',
'IN4148766',
'IN4148779',
'IN4148786',
'IN4148791',
'IN4148799',
'IN4148802',
'IN4148803',
'IN4148844',
'IN4149069',
'IN4149099',
'IN4149134',
'IN4149073',
'IN4042562',
'IN4067191',
'IN4068039',
'IN4068045',
'IN4068068',
'IN4068177',
'IN4081782',
'IN4082773',
'IN4083452',
'IN4083467',
'IN4083470',
'IN4083486',
'IN4083487',
'IN4083492',
'IN4083512',
'IN4083560',
'IN4125545',
'IN4135103',
'IN4148760',
'IN4148768',
'IN4148769',
'IN4148772',
'IN4148801',
'IN4148812',
'IN4148833',
'IN4148850',
'IN4149080',
'IN4149082',
'IN4149087',
'IN4149136',
'CM206673',
'IN4067188',
'IN4067195',
'IN4068049',
'IN4068055',
'IN4068067',
'IN4068069',
'IN4068089',
'IN4068102',
'IN4068109',
'IN4068145',
'IN4068146',
'IN4068150',
'IN4075786',
'IN4075807',
'IN4081745',
'IN4081766',
'IN4081779',
'IN4082791',
'IN4083485',
'IN4083504',
'IN4083505',
'IN4083534',
'IN4083543',
'IN4140501',
'IN4148749',
'IN4148754',
'IN4148770',
'IN4148788',
'IN4013037',
'CM208877',
'IN4062772',
'IN4062774',
'IN4068052',
'IN4068054',
'IN4068061',
'IN4068087',
'IN4068096',
'IN4068099',
'IN4068110',
'IN4068151',
'IN4068200',
'IN4082785',
'IN4083498',
'IN4083527',
'IN4083535',
'IN4083542',
'IN4148750',
'IN4148758',
'IN4148763',
'IN4148859',
'IN4149081',
'IN4149122',
'IN4149124',
'IN4149130',
'IN4149086',
'IN4149169',
'IN4150038',
'IN4150069',
'IN4150072',
'IN4067199',
'IN4068046',
'IN4068076',
'IN4068143',
'IN4068174',
'IN4081754',
'IN4083446',
'IN4083551',
'IN4083559',
'IN4083843',
'IN4142612',
'IN4148747',
'IN4148748',
'IN4148857',
'IN4148864',
'IN4149101',
'IN4149229',
'IN4149174',
'IN4150052',
'IN4150065',
'IN4150094',
'IN4150161',
'IN4150163',
'IN4150164',
'CM214043',
'IN4221397',
'IN4245408',
'IN4148842',
'IN4148861',
'IN4149102',
'IN4149117',
'IN4149143',
'IN4149201',
'IN4149226',
'IN4150040',
'IN4150051',
'IN4150075',
'IN4150092',
'IN4150101',
'IN4150106',
'IN4150169',
'IN4150170',
'IN4166990',
'CM214369',
'IN4232511',
'IN4245418',
'IN4245419',
'IN4245423',
'IN4245429',
'IN4245436',
'IN4245474',
'IN4246916',
'IN4246934',
'IN4246947',
'IN4246961',
'IN4246964',
'IN4246965',
'IN4246981',
'IN4246985',
'IN4247009',
'IN4247056',
'IN4247078',
'IN4247223',
'IN4247234',
'IN4148830',
'IN4148835',
'IN4148841',
'IN4148843',
'IN4148892',
'IN4149126',
'IN4149199',
'IN4149074',
'IN4149722',
'IN4150047',
'IN4150177',
'IN4150185',
'IN4150307',
'IN4150309',
'IN4178950',
'IN4179009',
'IN4242816',
'IN4245406',
'IN4245407',
'IN4245416',
'IN4245480',
'IN4246931',
'IN4246949',
'IN4246990',
'IN4247015',
'IN4247061',
'IN4247227',
'IN4247244',
'IN4247248',
'IN4247312',
'IN4248020',
'IN4250330',
'IN4250331',
'IN4253227',
'IN4148792',
'IN4148793',
'IN4148804',
'IN4148818',
'IN4148824',
'IN4149083',
'IN4149098',
'IN4149198',
'IN4149189',
'IN4149706',
'IN4150054',
'IN4150131',
'IN4150166',
'IN4150305',
'CM213213',
'CM213632',
'CM214223',
'IN4245410',
'IN4245413',
'IN4245421',
'IN4245425',
'IN4245439',
'IN4245477',
'IN4246906',
'IN4246946',
'IN4246948',
'IN4246954',
'IN4246967',
'IN4246971',
'IN4246986',
'IN4246989',
'IN4246993',
'IN4247004',
'IN4247060',
'IN4247237',
'IN4149202',
'IN4149264',
'IN4149125',
'IN4150091',
'IN4150130',
'IN4150359',
'CM214045',
'IN4245404',
'IN4245412',
'IN4245428',
'IN4245434',
'IN4245435',
'IN4245470',
'IN4245475',
'IN4245479',
'IN4246932',
'IN4246940',
'IN4246943',
'IN4246952',
'IN4246963',
'IN4247007',
'IN4247041',
'IN4247046',
'IN4247239',
'IN4247240',
'IN4250334',
'IN4253187',
'IN4253189',
'IN4253300',
'IN4253301',
'IN4253308',
'IN4253313',
'IN4280749',
'CM216573',
'IN4298587',
'IN4306817',
'IN4318219',
'IN4323293',
'IN4323301',
'IN4323302',
'IN4150067',
'IN4150173',
'IN4150179',
'IN4150311',
'IN4179365',
'IN4179382',
'CM214365',
'IN4245403',
'IN4245409',
'IN4245414',
'IN4245424',
'IN4245454',
'IN4245456',
'IN4245462',
'IN4245471',
'IN4245472',
'IN4246899',
'IN4246900',
'IN4246925',
'IN4246941',
'IN4246942',
'IN4246968',
'IN4246980',
'IN4246992',
'IN4246997',
'IN4247231',
'IN4247249',
'IN4247250',
'IN4253258',
'IN4253303',
'IN4253317',
'IN4262252',
'IN4268044',
'CM216051',
'IN4298588',
'IN4323304',
'IN4323309',
'IN4148854',
'IN4149114',
'IN4149139',
'IN4150104',
'IN4150133',
'IN4150158',
'IN4150172',
'IN4150180',
'IN4179366',
'IN4177792',
'CM214345',
'IN4245427',
'IN4246903',
'IN4246953',
'IN4246966',
'IN4246999',
'IN4247005',
'IN4252231',
'IN4253194',
'IN4253298',
'IN4323300',
'IN4323310',
'IN4323323',
'IN4323327',
'IN4323342',
'IN4323353',
'IN4323354',
'IN4323356',
'IN4323362',
'IN4149179',
'IN4149200',
'IN4150150',
'IN4150162',
'IN4150181',
'IN4150973',
'IN4156381',
'IN4177776',
'IN4179057',
'IN4245411',
'IN4245415',
'IN4245426',
'IN4245455',
'IN4245459',
'IN4245461',
'IN4245473',
'IN4246897',
'IN4246945',
'IN4246972',
'IN4246988',
'IN4247264',
'IN4252236',
'IN4253207',
'IN4253305',
'IN4253316',
'IN4262254',
'IN4274372',
'IN4288286',
'IN4298576',
'IN4302872',
'IN4150105',
'IN4150159',
'IN4150160',
'IN4150182',
'IN4150187',
'IN4150323',
'IN4245405',
'IN4245420',
'IN4245422',
'IN4245431',
'IN4246901',
'IN4246905',
'IN4246991',
'IN4246996',
'IN4247226',
'IN4247241',
'IN4247242',
'IN4247243',
'IN4247246',
'IN4247247',
'IN4247269',
'IN4252230',
'IN4253205',
'IN4253233',
'IN4253309',
'IN4253321',
'IN4271019',
'CM216481',
'IN4298567',
'CM216923',
'IN4323289',
'IN4323292',
'IN4323306',
'IN4323326',
'IN4323339',
'IN4245430',
'IN4245457',
'IN4245458',
'IN4246907',
'IN4246933',
'IN4246939',
'IN4246944',
'IN4246987',
'IN4246995',
'IN4247222',
'IN4248017',
'IN4250329',
'IN4253236',
'IN4253238',
'IN4253304',
'IN4253311',
'IN4298565',
'IN4288287',
'IN4306818',
'IN4318217',
'IN4323290',
'IN4323312',
'IN4323313',
'IN4323317',
'IN4323330',
'IN4323347',
'IN4323348',
'IN4323359',
'IN4323360',
'IN4323368',
'IN4323377',
'IN4323384',
'IN4247256',
'IN4247268',
'IN4252237',
'IN4253195',
'IN4253319',
'IN4253322',
'IN4298568',
'IN4302854',
'IN4317469',
'IN4318221',
'IN4323295',
'IN4323308',
'IN4323380',
'IN4323394',
'IN4323401',
'IN4323409',
'IN4323412',
'IN4323423',
'IN4323438',
'IN4323498',
'IN4323522',
'IN4323555',
'IN4323561',
'IN4323564',
'IN4326774',
'IN4326787',
'IN4326793',
'IN4326805',
'IN4326884',
'IN4326858',
'IN4334364',
'IN4356995',
'IN4378876',
'IN4378882',
'IN4401660',
'IN4405995',
'IN4405998',
'IN4406010',
'IN4406012',
'IN4406015',
'IN4406018',
'IN4406035',
'IN4406044',
'IN4247245',
'IN4250332',
'IN4253225',
'IN4253228',
'IN4253299',
'IN4253302',
'IN4253320',
'IN4253340',
'IN4298574',
'IN4298575',
'IN4318216',
'IN4323288',
'IN4323294',
'IN4323298',
'IN4323320',
'IN4323321',
'IN4323325',
'IN4323329',
'IN4323335',
'IN4323365',
'IN4323389',
'IN4323445',
'IN4323469',
'IN4323475',
'IN4323477',
'IN4323479',
'IN4323484',
'IN4323495',
'IN4323562',
'IN4326788',
'IN4326798',
'IN4326863',
'IN4326894',
'IN4326897',
'IN4326908',
'IN4326909',
'IN4330418',
'IN4323431',
'IN4306803',
'IN4323318',
'IN4323328',
'IN4323351',
'IN4323363',
'IN4323367',
'IN4323381',
'IN4323460',
'IN4323471',
'IN4323474',
'IN4323486',
'IN4323490',
'IN4323499',
'IN4323554',
'IN4326801',
'IN4326835',
'IN4326836',
'IN4326887',
'IN4323560',
'IN4356953',
'IN4378874',
'IN4391763',
'IN4392231',
'IN4397469',
'IN4405982',
'IN4405993',
'IN4406003',
'IN4406004',
'IN4406022',
'IN4406026',
'IN4406028',
'IN4406063',
'IN4406075',
'IN4406117',
'IN4406124',
'IN4406125',
'IN4406141',
'IN4406148',
'IN4406153',
'IN4406180',
'IN4406193',
'IN4323303',
'IN4323305',
'IN4323324',
'IN4323332',
'IN4323349',
'IN4323355',
'IN4323371',
'IN4323410',
'IN4323463',
'IN4323481',
'IN4323496',
'IN4323523',
'IN4323546',
'IN4323553',
'IN4326827',
'IN4326889',
'IN4326890',
'IN4326899',
'IN4330409',
'IN4330417',
'IN4334347',
'IN4372071',
'IN4405973',
'IN4405975',
'IN4405979',
'IN4406047',
'IN4406065',
'IN4406132',
'IN4406135',
'IN4406154',
'IN4406213',
'IN4406215',
'IN4406223',
'IN4406267',
'IN4406068',
'IN4406160',
'IN4409485',
'IN4409494',
'IN4406209',
'IN4406219',
'IN4323372',
'IN4323379',
'IN4323419',
'IN4323428',
'IN4323442',
'IN4323468',
'IN4323483',
'IN4323521',
'IN4326886',
'IN4326891',
'IN4330424',
'IN4330724',
'IN4378868',
'IN4378871',
'IN4401666',
'IN4405974',
'IN4405978',
'IN4406005',
'IN4406007',
'IN4406024',
'IN4406048',
'IN4406057',
'IN4406064',
'IN4406069',
'IN4406074',
'IN4406112',
'IN4406143',
'IN4406146',
'IN4406194',
'IN4406206',
'IN4406224',
'IN4406225',
'IN4406241',
'IN4406086',
'IN4406183',
'IN4409484',
'IN4406207',
'IN4411973',
'IN4335484',
'IN4357000',
'IN4357791',
'IN4405997',
'IN4406008',
'IN4406009',
'IN4406027',
'IN4406062',
'IN4406066',
'IN4406067',
'IN4406092',
'IN4406130',
'IN4406138',
'IN4406167',
'IN4406169',
'IN4406174',
'IN4406222',
'IN4406076',
'IN4408800',
'IN4406020',
'IN4406220',
'IN4406221',
'IN4411951',
'IN4411980',
'IN4406256',
'IN4406182',
'IN4408791',
'IN4409488',
'IN4409498',
'IN4411850',
'IN4411966',
'IN4411979',
'IN4323357',
'IN4323366',
'IN4323392',
'IN4323408',
'IN4323413',
'IN4323417',
'IN4323418',
'IN4323432',
'IN4323433',
'IN4323464',
'IN4323491',
'IN4323510',
'IN4326810',
'IN4323501',
'IN4351599',
'IN4379992',
'IN4401659',
'IN4405977',
'IN4405985',
'IN4406017',
'IN4406060',
'IN4406119',
'IN4406139',
'IN4406178',
'IN4406181',
'IN4406198',
'IN4406228',
'IN4406249',
'IN4406250',
'IN4406265',
'IN4406113',
'IN4406203',
'IN4403636',
'IN4406240',
'IN4406247',
'IN4408807',
'IN4406059',
'IN4406073',
'IN4406080',
'IN4406087',
'IN4406094',
'IN4406101',
'IN4406105',
'IN4406111',
'IN4406116',
'IN4406147',
'IN4406192',
'IN4406230',
'IN4406269',
'IN4406195',
'IN4408790',
'IN4408795',
'IN4411954',
'IN4411955',
'IN4411965',
'IN4411971',
'IN4302874',
'IN4323291',
'IN4323336',
'IN4323338',
'IN4323385',
'IN4323443',
'IN4326869',
'IN4326902',
'IN4326904',
'IN4330412',
'IN4330415',
'IN4330431',
'IN4330432',
'IN4334348',
'IN4356997',
'IN4357006',
'IN4357008',
'IN4378881',
'IN4392219',
'IN4401662',
'IN4405983',
'IN4406014',
'IN4406038',
'IN4406040',
'IN4406056',
'IN4406071',
'IN4406104',
'IN4406115',
'IN4406123',
'IN4406152',
'IN4406179',
'IN4406218',
'IN4406231',
'IN4323467',
'IN4323547',
'IN4326781',
'IN4326885',
'IN4330411',
'IN4323421',
'IN4334346',
'IN4351594',
'IN4357007',
'IN4406025',
'IN4406036',
'IN4406046',
'IN4406070',
'IN4406109',
'IN4406140',
'IN4406142',
'IN4406227',
'IN4408786',
'IN4406232',
'IN4408806',
'IN4411950',
'IN4411953',
'IN4409922',
'IN4411956',
'IN4411969',
'IN4406238',
'IN4406118',
'IN4411962',
'IN4323319',
'IN4323333',
'IN4323370',
'IN4323378',
'IN4323382',
'IN4323383',
'IN4323411',
'IN4323461',
'IN4323497',
'IN4323500',
'IN4323548',
'IN4326789',
'IN4326888',
'IN4326896',
'IN4330421',
'IN4356996',
'IN4405981',
'IN4406000',
'IN4406011',
'IN4406041',
'IN4406055',
'IN4406072',
'IN4406102',
'IN4406108',
'IN4406120',
'IN4406126',
'IN4406162',
'IN4406164',
'IN4406176',
'IN4408798',
'IN4406013',
'IN4409960',
'IN4411957',
'IN4411974'


	)
group by			
	gl.[Document No_],
	gl.[Posting Date],
	gl.[Document Date],
	gl.[Global Dimension 2 Code]) q1
--where
--	q1.sales = 0
--	and abs(q1.cost) > 0